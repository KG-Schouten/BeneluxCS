<!DOCTYPE html>
{% extends "base.html" %}

{% from "macros/match_box.html" import match_box %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/esea/esea.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/esea/esea_sidebar.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/esea/esea_cards.css') }}">

<link rel="stylesheet" href="{{ url_for('static', filename='css/components/match_box.css') }}">
{% endblock %}

{% block title %}ESEA{% endblock %}

{% block content %}

<!-- center-aligned tabs -->
<div class="esea-page-wrapper">
  <div class="sidebar left">
  </div>

  <div class="esea-wrapper">
    <div class="position-relative text-center">
      <!-- Banner Image -->
      <img id="seasonBanner" src="{{ season_info[0].event_banner }}" alt="Season Banner" class="img-fluid"/>

      <!-- Season nav container -->
      <div class="season-nav-box">
        <ul class="season-nav" id="eseaTabs" role="tablist">
          {% for season in season_info %}
            {% set label = "" %}
            {% if season.event_start and season.event_end %}
              {% if current_time >= season.event_start and current_time <= season.event_end %}
                {% set label = "LIVE" %}
              {% elif current_time >= season.event_start - 604800 and current_time < season.event_start %}
                {% set label = "SOON" %}
              {% endif %}
            {% endif %}
            <li class="nav-item" role="presentation">
              <button 
                class="nav-link season-nav-link {% if loop.first %}active{% endif %}" 
                id="season-tab-{{ season.season_number }}"
                data-season="{{ season.season_number }}"
                data-banner="{{ season.event_banner }}"
                type="button"
                role="tab">

                <span>S-{{ season.season_number }}</span>
                {% if label %}
                  <span class="badge bg-secondary">{{ label }}</span>
                {% endif %}
              </button>
            </li>
          {% endfor %}
          <li class="nav-item dropdown d-none">
            <button class="nav-link dropdown-toggle" id="DropdownMenu" role="button" data-bs-toggle="dropdown" aria-expanded="false">
              More
            </button>
            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="DropdownMenu">
              <!-- Dropdown items will be added dynamically -->
            </ul>
          </li>
        </ul>
      </div>
    </div>

    <!-- Content container -->
    <div class="tab-content mt-4" id="season-content">
      <div class="text-muted">Loading...</div>
    </div>
  </div>
  <div class="sidebar right">

    <div class="sidebar-content">
      <div class="sidebar-header">
        <span> Benelux Clashes </span>
      </div>
      <div class="sidebar-body">
        {% if has_benelux_matches %}
          {% for division, matches in benelux_matches.items() %}
            {% for match in matches %}
              {{ match_box(division, match) }}
            {% endfor %}
          {% endfor %}
        {% else %}
          <div class="text-muted"> No upcoming Benelux clashes :( </div>
        {% endif %}
        
      </div>
    </div>

    <div class="sidebar-content">
      <div class="sidebar-header">
        <span> Today's Matches </span>
      </div>
      <div class="sidebar-body">
        {% if has_todays_matches %}
          {% for division, matches in todays_matches.items() %}
            {% if matches %}
              <div class="todays-matches-division">
                {{ division }}
              </div>
              {% for match in matches %}
                {{ match_box(division, match) }}
              {% endfor %}
            {% endif %}
          {% endfor %}
        {% else %}
          <div class="text-muted"> No matches scheduled for today. </div>
        {% endif %}
      </div>
    </div>
  </div>
</div>

{% endblock %}

{% block javascript %}
  {{ super() }}
  <script src="{{ url_for('static', filename='js/esea.js') }}"></script>
{% endblock %}