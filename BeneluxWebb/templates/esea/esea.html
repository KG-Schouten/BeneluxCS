<!DOCTYPE html>
{% extends "base.html" %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/sidebar.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/table/table.css') }}">

<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/esea/esea.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/esea/esea_sidebar.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/esea/esea_cards.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/pages/esea/esea_potw.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/streams.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/components/loader.css') }}">
{% endblock %}

{% block title %}{{ super() }} | ESEA{% endblock %}

{% block content %}

<!-- center-aligned tabs -->
<div class="esea-page-wrapper">
  <div class="sidebar left">
    <!-- Player Highlights -->
    <div class="sidebar-content">
      <div class="sidebar-header">
        <span> Player Highlights </span>
      </div>
      <div class="sidebar-body">
        {% include 'esea/esea_potw.html' %}
      </div>
    </div>

    <!-- Streams -->
    <div class="sidebar-content">
      <div class="sidebar-header">
        <span> Streams </span>
      </div>
      <div class="sidebar-body">
        {% include 'macros/streams/streams.html' %}
      </div>
    </div>

  </div>

  <div class="esea-wrapper">
    <div class="position-relative text-center">
      <!-- Banner Image -->
      <!-- <img id="seasonBanner" src="{{ season_info[0].event_banner }}" alt="Season Banner" class="img-fluid"/> -->
      <img id="seasonBanner" src="{{ url_for('static', filename='img/esea/ESEA_Banner_bg.png') }}" alt="Season Banner" class="img-fluid"/>

      <!-- Season nav container -->
      <div class="season-nav-box">
        <ul class="season-nav" id="eseaTabs" role="tablist">
          {% for season in season_info %}
            {% set label = "" %}
            {% if season.event_start and season.event_end %}
              {% if current_time >= season.event_start and current_time <= season.event_end %}
                {% set label = "LIVE" %}
              {% elif current_time >= season.event_start - 604800 and current_time < season.event_start %}
                {% set label = "Starting Soon" %}
              {% endif %}
            {% endif %}
            <li class="nav-item {% if loop.first %}active{% endif %}" role="presentation" data-season="{{ season.season_number }}">
              <span>S-{{ season.season_number }}</span>
              {% if label %}
                <span class="badge nav-badge">{{ label }}</span>
              {% endif %}
            </li>
          {% endfor %}
        </ul>

        <div class="nav-item d-none" id="eseaDropdown">
          <div class="nav-link" id="DropdownBtn">
            <i class="bi bi-three-dots"></i>
          </div>
          <div id="DropdownMenu">
            <!-- Dropdown items will be added dynamically -->
          </div>
        </div>

      </div>
    </div>

    <!-- Content container -->
    <div class="tab-content mt-4" id="season-content">
      <div class="text-muted">Loading...</div>
    </div>
    
  </div>

  <div class="sidebar right">
    
    <!-- Discord link -->
    <div class="sidebar-content">
      <div class="sidebar-header hoverable">
        <a href="https://discord.gg/9xzsGTGhjm" 
            target="_blank" 
            rel="noopener noreferrer" 
            style="margin: 10px 5px" 
            onclick="plausible('Discord Join Click')">
          <img src="{{ url_for('static', filename='img/join_discord.png') }}" alt="Join the Discord" class="img-fluid sidebar-discord"/>
        </a>
      </div>
    </div>

    <!-- Matches -->
    <div class="sidebar-content" id="matches-sidebar">
      {% include 'esea/esea_matches.html' %}
    </div>

  </div>
</div>

{% endblock %}

{% block javascript %}
  {{ super() }}
  <script type="module" src="{{ url_for('static', filename='js/esea/esea.js') }}"></script>
{% endblock %}