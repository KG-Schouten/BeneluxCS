{% macro dual_range_slider(minval, maxval, step, slider_name) %}
<div class="range-slider-container sidebar-button" data-slider-name="{{ slider_name }}">
    <div class="range-slider">
        <span class="slider-track"></span>
        <input type="range" name="min_val" class="min-val" min="{{ minval }}" max="{{ maxval }}" value="{{ minval }}" step="{{ step }}">
        <input type="range" name="max_val" class="max-val" min="{{ minval }}" max="{{ maxval }}" value="{{ maxval }}" step="{{ step }}">
    </div>
    <div class="range-values">
        <span class="min-range-value"></span>
        <span>-</span>
        <span class="max-range-value"></span>
    </div>
</div>

<script>
(function() {
    document.querySelectorAll('.range-slider-container').forEach(sliderContainer => {
        const minVal = sliderContainer.querySelector('.min-val');
        const maxVal = sliderContainer.querySelector('.max-val');
        const minRangeValue = sliderContainer.querySelector('.min-range-value');
        const maxRangeValue = sliderContainer.querySelector('.max-range-value');
        const range = sliderContainer.querySelector('.slider-track');

        const sliderMaxValue = parseFloat(maxVal.max);

        function slideMin() {
            if (parseFloat(minVal.value) > parseFloat(maxVal.value)) {
                minVal.value = maxVal.value;
            }
            minRangeValue.textContent = minVal.value;
            setArea();
        }

        function slideMax() {
            if (parseFloat(maxVal.value) < parseFloat(minVal.value)) {
                maxVal.value = minVal.value;
            }
            maxRangeValue.textContent = maxVal.value;
            setArea();
        }

        function setArea() {
            const minPercent = (minVal.value / sliderMaxValue) * 100;
            const maxPercent = (maxVal.value / sliderMaxValue) * 100;
            range.style.left = minPercent + '%';
            range.style.right = (100 - maxPercent) + '%';
        }

        // Initialize slider
        slideMin();
        slideMax();

        // Attach event listeners
        minVal.addEventListener('input', slideMin);
        maxVal.addEventListener('input', slideMax);
    });
})();
</script>
{% endmacro %}